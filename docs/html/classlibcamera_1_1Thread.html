<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JetPackJoyRide: libcamera::Thread Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">JetPackJoyRide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibcamera.html">libcamera</a></li><li class="navelem"><a class="el" href="classlibcamera_1_1Thread.html">Thread</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classlibcamera_1_1Thread-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libcamera::Thread Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A thread of execution.  
 <a href="classlibcamera_1_1Thread.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for libcamera::Thread:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classlibcamera_1_1Thread.png" usemap="#libcamera::Thread_map" alt=""/>
  <map id="libcamera::Thread_map" name="libcamera::Thread_map">
<area href="classCancelThread.html" alt="CancelThread" shape="rect" coords="0,56,214,80"/>
<area href="classDelayThread.html" alt="DelayThread" shape="rect" coords="224,56,438,80"/>
<area href="classDeleterThread.html" alt="DeleterThread" shape="rect" coords="448,56,662,80"/>
<area href="classlibcamera_1_1CameraManager_1_1Private.html" alt="libcamera::CameraManager::Private" shape="rect" coords="672,56,886,80"/>
<area href="classlibcamera_1_1ThreadMain.html" title="Thread wrapper for the main thread." alt="libcamera::ThreadMain" shape="rect" coords="896,56,1110,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad3bf41ff4d660ed68ed2c75a02526b3a" id="r_ad3bf41ff4d660ed68ed2c75a02526b3a"><td class="memItemLeft" align="right" valign="top"><a id="ad3bf41ff4d660ed68ed2c75a02526b3a" name="ad3bf41ff4d660ed68ed2c75a02526b3a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Thread</b> ()</td></tr>
<tr class="memdesc:ad3bf41ff4d660ed68ed2c75a02526b3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a thread. <br /></td></tr>
<tr class="separator:ad3bf41ff4d660ed68ed2c75a02526b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a41ff49b92b165721070c0199de3df6" id="r_a7a41ff49b92b165721070c0199de3df6"><td class="memItemLeft" align="right" valign="top"><a id="a7a41ff49b92b165721070c0199de3df6" name="a7a41ff49b92b165721070c0199de3df6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>start</b> ()</td></tr>
<tr class="memdesc:a7a41ff49b92b165721070c0199de3df6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the thread. <br /></td></tr>
<tr class="separator:a7a41ff49b92b165721070c0199de3df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682e194cb85201f751679d405bddd390" id="r_a682e194cb85201f751679d405bddd390"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390">exit</a> (int code=0)</td></tr>
<tr class="memdesc:a682e194cb85201f751679d405bddd390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the thread's event loop.  <br /></td></tr>
<tr class="separator:a682e194cb85201f751679d405bddd390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8b4e36644bbb12dc4a3652875031c0" id="r_aad8b4e36644bbb12dc4a3652875031c0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#aad8b4e36644bbb12dc4a3652875031c0">wait</a> (<a class="el" href="include_2libcamera_2base_2utils_8h.html#ad2a71f9eb2c27cd6213306d8d2ff7fd0">utils::duration</a> duration=utils::duration::max())</td></tr>
<tr class="memdesc:aad8b4e36644bbb12dc4a3652875031c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for the thread to finish.  <br /></td></tr>
<tr class="separator:aad8b4e36644bbb12dc4a3652875031c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0aaa9e86d23aae87865d5b607263434" id="r_ac0aaa9e86d23aae87865d5b607263434"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#ac0aaa9e86d23aae87865d5b607263434">setThreadAffinity</a> (const <a class="el" href="classlibcamera_1_1Span.html">Span</a>&lt; const unsigned int &gt; &amp;cpus)</td></tr>
<tr class="memdesc:ac0aaa9e86d23aae87865d5b607263434"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the CPU affinity mask of the thread.  <br /></td></tr>
<tr class="separator:ac0aaa9e86d23aae87865d5b607263434"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc82f4273c701d2a3e10c616ae7be167" id="r_abc82f4273c701d2a3e10c616ae7be167"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#abc82f4273c701d2a3e10c616ae7be167">isRunning</a> ()</td></tr>
<tr class="memdesc:abc82f4273c701d2a3e10c616ae7be167"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the thread is running.  <br /></td></tr>
<tr class="separator:abc82f4273c701d2a3e10c616ae7be167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473e4d310c13ca3e779781116b6df125" id="r_a473e4d310c13ca3e779781116b6df125"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibcamera_1_1EventDispatcher.html">EventDispatcher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a473e4d310c13ca3e779781116b6df125">eventDispatcher</a> ()</td></tr>
<tr class="memdesc:a473e4d310c13ca3e779781116b6df125"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the event dispatcher.  <br /></td></tr>
<tr class="separator:a473e4d310c13ca3e779781116b6df125"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e5281fd59e9644aab27c0a5fefe7ed" id="r_aa9e5281fd59e9644aab27c0a5fefe7ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#aa9e5281fd59e9644aab27c0a5fefe7ed">dispatchMessages</a> (<a class="el" href="classlibcamera_1_1Message.html#a7ae15d74f028344ba827ea8ba4d77fa5">Message::Type</a> type=<a class="el" href="classlibcamera_1_1Message.html#a7ae15d74f028344ba827ea8ba4d77fa5a2cf8f48814353e436d4f5fc4b9f8b713">Message::Type::None</a>)</td></tr>
<tr class="memdesc:aa9e5281fd59e9644aab27c0a5fefe7ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch posted messages for this thread.  <br /></td></tr>
<tr class="separator:aa9e5281fd59e9644aab27c0a5fefe7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a3eef596f48cb7109462118890b6575cb" id="r_a3eef596f48cb7109462118890b6575cb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibcamera_1_1Thread.html">Thread</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a3eef596f48cb7109462118890b6575cb">current</a> ()</td></tr>
<tr class="memdesc:a3eef596f48cb7109462118890b6575cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instance for the current thread \context This function is \threadsafe.  <br /></td></tr>
<tr class="separator:a3eef596f48cb7109462118890b6575cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f93a5a8f2649c06859f88325dc60ac" id="r_a41f93a5a8f2649c06859f88325dc60ac"><td class="memItemLeft" align="right" valign="top">static pid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a41f93a5a8f2649c06859f88325dc60ac">currentId</a> ()</td></tr>
<tr class="memdesc:a41f93a5a8f2649c06859f88325dc60ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the ID of the current thread.  <br /></td></tr>
<tr class="separator:a41f93a5a8f2649c06859f88325dc60ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7f3bdc2840090cfb00fa8442ce36c3df" id="r_a7f3bdc2840090cfb00fa8442ce36c3df"><td class="memItemLeft" align="right" valign="top"><a id="a7f3bdc2840090cfb00fa8442ce36c3df" name="a7f3bdc2840090cfb00fa8442ce36c3df"></a>
<a class="el" href="classlibcamera_1_1Signal.html">Signal</a>&#160;</td><td class="memItemRight" valign="bottom"><b>finished</b></td></tr>
<tr class="memdesc:a7f3bdc2840090cfb00fa8442ce36c3df"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlibcamera_1_1Signal.html" title="Generic signal and slot communication mechanism.">Signal</a> the end of thread execution. <br /></td></tr>
<tr class="separator:a7f3bdc2840090cfb00fa8442ce36c3df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a6422ed835177fd84f0e517efc798fa62" id="r_a6422ed835177fd84f0e517efc798fa62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62">exec</a> ()</td></tr>
<tr class="memdesc:a6422ed835177fd84f0e517efc798fa62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enter the event loop.  <br /></td></tr>
<tr class="separator:a6422ed835177fd84f0e517efc798fa62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7d63b01477fa9987f5505f82f32913" id="r_a7e7d63b01477fa9987f5505f82f32913"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913">run</a> ()</td></tr>
<tr class="memdesc:a7e7d63b01477fa9987f5505f82f32913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of the thread.  <br /></td></tr>
<tr class="separator:a7e7d63b01477fa9987f5505f82f32913"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a0720b5f434e636e22a3ed34f847eec57" id="r_a0720b5f434e636e22a3ed34f847eec57"><td class="memItemLeft" align="right" valign="top"><a id="a0720b5f434e636e22a3ed34f847eec57" name="a0720b5f434e636e22a3ed34f847eec57"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>Object</b></td></tr>
<tr class="separator:a0720b5f434e636e22a3ed34f847eec57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78cce72f7d53e176c798dc78aa1b8313" id="r_a78cce72f7d53e176c798dc78aa1b8313"><td class="memItemLeft" align="right" valign="top"><a id="a78cce72f7d53e176c798dc78aa1b8313" name="a78cce72f7d53e176c798dc78aa1b8313"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadData</b></td></tr>
<tr class="separator:a78cce72f7d53e176c798dc78aa1b8313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb5b1774a040ba637e7a1e47bb686eaf" id="r_acb5b1774a040ba637e7a1e47bb686eaf"><td class="memItemLeft" align="right" valign="top"><a id="acb5b1774a040ba637e7a1e47bb686eaf" name="acb5b1774a040ba637e7a1e47bb686eaf"></a>
class&#160;</td><td class="memItemRight" valign="bottom"><b>ThreadMain</b></td></tr>
<tr class="separator:acb5b1774a040ba637e7a1e47bb686eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A thread of execution. </p>
<p>The <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> class is a wrapper around std::thread that handles integration with the <a class="el" href="classlibcamera_1_1Object.html" title="Base object to support automatic signal disconnection.">Object</a>, <a class="el" href="classlibcamera_1_1Signal.html" title="Generic signal and slot communication mechanism.">Signal</a> and <a class="el" href="classlibcamera_1_1EventDispatcher.html" title="Interface to manage the libcamera events and timers.">EventDispatcher</a> classes.</p>
<p><a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instances by default run an event loop until the <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> function is called. The event loop dispatches events (messages, notifiers and timers) sent to the objects living in the thread. This behaviour can be modified by overriding the <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function.</p>
<h1><a class="anchor" id="thread-stop"></a>
Stopping Threads</h1>
<p>Threads can't be forcibly stopped. Instead, a thread user first requests the thread to exit and then waits for the thread's main function to react to the request and return, at which points the thread will stop.</p>
<p>For threads running <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a>, the <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> function is used to request the thread to exit. For threads subclassing the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> class and implementing a custom <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function, a subclass-specific mechanism shall be provided. In either case, the <a class="el" href="classlibcamera_1_1Thread.html#aad8b4e36644bbb12dc4a3652875031c0" title="Wait for the thread to finish.">wait()</a> function shall be called to wait for the thread to stop.</p>
<p>Due to their asynchronous nature, threads are subject to race conditions when they stop. This is of particular importance for messages posted to the thread with postMessage() (and the other mechanisms that rely on it, such as <a class="el" href="classlibcamera_1_1Object.html#a2a4ea2209e289e2aabb75c5718d5b4a7" title="Invoke a method asynchronously on an Object instance.">Object::invokeMethod()</a> or asynchronous signal delivery). To understand the issues, three contexts need to be considered:</p>
<ul>
<li>The worker is the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> performing work and being instructed to stop.</li>
<li>The controller is the context which instructs the worker thread to stop.</li>
<li>The other contexts are any threads other than the worker and controller that interact with the worker thread.</li>
</ul>
<p>Messages posted to the worker thread from the controller context before calling <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> are queued to the thread's message queue, and the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> class offers no guarantee that those messages will be processed before the thread stops. This allows threads to stop fast.</p>
<p>A thread that requires delivery of messages posted from the controller context before <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> should reimplement the <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function and call <a class="el" href="classlibcamera_1_1Thread.html#aa9e5281fd59e9644aab27c0a5fefe7ed" title="Dispatch posted messages for this thread.">dispatchMessages()</a> after <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a>.</p>
<p>Messages posted to the worker thread from the other contexts are asynchronous with respect to the <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> call from the controller context. There is no guarantee as to whether those messages will be processed or not before the thread stops.</p>
<p>Messages that are not processed will stay in the queue, in the exact same way as messages posted after the thread has stopped. They will be processed when the thread is restarted. If the thread is never restarted, they will be deleted without being processed when the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instance is destroyed. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a3eef596f48cb7109462118890b6575cb" name="a3eef596f48cb7109462118890b6575cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eef596f48cb7109462118890b6575cb">&#9670;&#160;</a></span>current()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibcamera_1_1Thread.html">Thread</a> * libcamera::Thread::current </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instance for the current thread \context This function is \threadsafe. </p>
<dl class="section return"><dt>Returns</dt><dd>The <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instance for the current thread </dd></dl>

</div>
</div>
<a id="a41f93a5a8f2649c06859f88325dc60ac" name="a41f93a5a8f2649c06859f88325dc60ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f93a5a8f2649c06859f88325dc60ac">&#9670;&#160;</a></span>currentId()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pid_t libcamera::Thread::currentId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the ID of the current thread. </p>
<p>The thread ID corresponds to the Linux thread ID (TID) as returned by the gettid system call.</p>
<p>\context This function is \threadsafe.</p>
<dl class="section return"><dt>Returns</dt><dd>The ID of the current thread </dd></dl>

</div>
</div>
<a id="aa9e5281fd59e9644aab27c0a5fefe7ed" name="aa9e5281fd59e9644aab27c0a5fefe7ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e5281fd59e9644aab27c0a5fefe7ed">&#9670;&#160;</a></span>dispatchMessages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::Thread::dispatchMessages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1Message.html#a7ae15d74f028344ba827ea8ba4d77fa5">Message::Type</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="classlibcamera_1_1Message.html#a7ae15d74f028344ba827ea8ba4d77fa5a2cf8f48814353e436d4f5fc4b9f8b713">Message::Type::None</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch posted messages for this thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>The message type</td></tr>
  </table>
  </dd>
</dl>
<p>This function immediately dispatches all the messages previously posted for this thread with postMessage() that match the message <em>type</em>. If the <em>type</em> is <a class="el" href="classlibcamera_1_1Message.html#a7ae15d74f028344ba827ea8ba4d77fa5a2cf8f48814353e436d4f5fc4b9f8b713" title="Invalid message type.">Message::Type::None</a>, all messages are dispatched.</p>
<p>Messages shall only be dispatched from the current thread, typically within the thread from the <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function. Calling this function outside of the thread results in undefined behaviour.</p>
<p>This function is not thread-safe, but it may be called recursively in the same thread from an object's message handler. It guarantees delivery of messages in the order they have been posted in all cases. </p>

</div>
</div>
<a id="a473e4d310c13ca3e779781116b6df125" name="a473e4d310c13ca3e779781116b6df125"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473e4d310c13ca3e779781116b6df125">&#9670;&#160;</a></span>eventDispatcher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibcamera_1_1EventDispatcher.html">EventDispatcher</a> * libcamera::Thread::eventDispatcher </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the event dispatcher. </p>
<p>This function retrieves the internal event dispatcher for the thread. The returned event dispatcher is valid until the thread is destroyed.</p>
<p>\context This function is \threadsafe.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the event dispatcher </dd></dl>

</div>
</div>
<a id="a6422ed835177fd84f0e517efc798fa62" name="a6422ed835177fd84f0e517efc798fa62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6422ed835177fd84f0e517efc798fa62">&#9670;&#160;</a></span>exec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::Thread::exec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enter the event loop. </p>
<p>This function enters an event loop based on the event dispatcher instance for the thread, and blocks until the <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> function is called. It is meant to be called within the thread from the <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function and shall not be called outside of the thread.</p>
<dl class="section return"><dt>Returns</dt><dd>The exit code passed to the <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> function </dd></dl>

</div>
</div>
<a id="a682e194cb85201f751679d405bddd390" name="a682e194cb85201f751679d405bddd390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682e194cb85201f751679d405bddd390">&#9670;&#160;</a></span>exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::Thread::exit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>code</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the thread's event loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">code</td><td>The exit code</td></tr>
  </table>
  </dd>
</dl>
<p>This function interrupts the event loop started by the <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a> function, causing <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a> to return <em>code</em>.</p>
<p>Calling <a class="el" href="classlibcamera_1_1Thread.html#a682e194cb85201f751679d405bddd390" title="Stop the thread&#39;s event loop.">exit()</a> on a thread that reimplements the <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function and doesn't call <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a> will likely have no effect.</p>
<p>\context This function is \threadsafe. </p>

</div>
</div>
<a id="abc82f4273c701d2a3e10c616ae7be167" name="abc82f4273c701d2a3e10c616ae7be167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc82f4273c701d2a3e10c616ae7be167">&#9670;&#160;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libcamera::Thread::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the thread is running. </p>
<p>A <a class="el" href="classlibcamera_1_1Thread.html" title="A thread of execution.">Thread</a> instance is considered as running once the underlying thread has started. This function guarantees that it returns true after the <a class="el" href="classlibcamera_1_1Thread.html#a7a41ff49b92b165721070c0199de3df6" title="Start the thread.">start()</a> function returns, and false after the <a class="el" href="classlibcamera_1_1Thread.html#aad8b4e36644bbb12dc4a3652875031c0" title="Wait for the thread to finish.">wait()</a> function returns.</p>
<p>\context This function is \threadsafe.</p>
<dl class="section return"><dt>Returns</dt><dd>True if the thread is running, false otherwise </dd></dl>

</div>
</div>
<a id="a7e7d63b01477fa9987f5505f82f32913" name="a7e7d63b01477fa9987f5505f82f32913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e7d63b01477fa9987f5505f82f32913">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::Thread::run </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main function of the thread. </p>
<p>When the thread is started with <a class="el" href="classlibcamera_1_1Thread.html#a7a41ff49b92b165721070c0199de3df6" title="Start the thread.">start()</a>, it calls this function in the context of the new thread. The <a class="el" href="classlibcamera_1_1Thread.html#a7e7d63b01477fa9987f5505f82f32913" title="Main function of the thread.">run()</a> function can be overridden to perform custom work, either custom initialization and cleanup before and after calling the <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">Thread::exec()</a> function, or a custom thread loop altogether. When this function returns the thread execution is stopped, and the <a class="el" href="classlibcamera_1_1Thread.html#a7f3bdc2840090cfb00fa8442ce36c3df">finished</a> signal is emitted.</p>
<p>Note that if this function is overridden and doesn't call <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">Thread::exec()</a>, no events will be dispatched to the objects living in the thread. These objects will not be able to use the <a class="el" href="classlibcamera_1_1EventNotifier.html" title="Notify of activity on a file descriptor.">EventNotifier</a>, <a class="el" href="classlibcamera_1_1Timer.html" title="Single-shot timer interface.">Timer</a> or <a class="el" href="classlibcamera_1_1Message.html" title="A message that can be posted to a Thread.">Message</a> facilities. This includes functions that rely on message dispatching, such as <a class="el" href="classlibcamera_1_1Object.html#a7432a52a2e69a29cfe8144929686d1e6" title="Schedule deletion of the instance in the thread it belongs to.">Object::deleteLater()</a>.</p>
<p>The base implementation just calls <a class="el" href="classlibcamera_1_1Thread.html#a6422ed835177fd84f0e517efc798fa62" title="Enter the event loop.">exec()</a>. </p>

<p>Reimplemented in <a class="el" href="classDeleterThread.html#a1d112d2fe445b4823f645a31a30c4ae3">DeleterThread</a>, <a class="el" href="classDelayThread.html#ac07540dd0f7d3ee6b3de2ffbb9e08fb4">DelayThread</a>, <a class="el" href="classCancelThread.html#a414ce279d0ced35c5c7cf55153a2d033">CancelThread</a>, <a class="el" href="classlibcamera_1_1CameraManager_1_1Private.html#a2495e76af68debe46f1fbdc770a73085">libcamera::CameraManager::Private</a>, and <a class="el" href="classlibcamera_1_1ThreadMain.html#a06fd0d5ebb23cac7587793d2203b54ac">libcamera::ThreadMain</a>.</p>

</div>
</div>
<a id="ac0aaa9e86d23aae87865d5b607263434" name="ac0aaa9e86d23aae87865d5b607263434"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0aaa9e86d23aae87865d5b607263434">&#9670;&#160;</a></span>setThreadAffinity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::Thread::setThreadAffinity </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibcamera_1_1Span.html">Span</a>&lt; const unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>cpus</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the CPU affinity mask of the thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cpus</td><td>The list of CPU indices that the thread is set affinity to</td></tr>
  </table>
  </dd>
</dl>
<p>The CPU indices should be within [0, std::thread::hardware_concurrency()). If any index is invalid, this function won't modify the thread affinity and will return an error.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if all indices are valid, -EINVAL otherwise </dd></dl>

</div>
</div>
<a id="aad8b4e36644bbb12dc4a3652875031c0" name="aad8b4e36644bbb12dc4a3652875031c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8b4e36644bbb12dc4a3652875031c0">&#9670;&#160;</a></span>wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libcamera::Thread::wait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2libcamera_2base_2utils_8h.html#ad2a71f9eb2c27cd6213306d8d2ff7fd0">utils::duration</a>&#160;</td>
          <td class="paramname"><em>duration</em> = <code>utils::duration::max()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for the thread to finish. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">duration</td><td>Maximum wait duration</td></tr>
  </table>
  </dd>
</dl>
<p>This function waits until the thread finishes or the <em>duration</em> has elapsed, whichever happens first. If <em>duration</em> is equal to utils::duration::max(), the wait never times out. If the thread is not running the function returns immediately.</p>
<p>\context This function is \threadsafe.</p>
<dl class="section return"><dt>Returns</dt><dd>True if the thread has finished, or false if the wait timed out </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/peripherals/camera/libcamera/include/libcamera/base/<a class="el" href="thread_8h_source.html">thread.h</a></li>
<li>src/peripherals/camera/libcamera/src/libcamera/base/<b>thread.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
