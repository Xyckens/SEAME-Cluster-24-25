\doxysection{libcamera\+::ipa\+::Camera\+Sensor\+Helper Class Reference}
\hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper}{}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper}\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}


Base class for computing sensor tuning parameters using sensor-\/specific constants.  


Inheritance diagram for libcamera\+::ipa\+::Camera\+Sensor\+Helper\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=12.000000cm]{classlibcamera_1_1ipa_1_1CameraSensorHelper}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structlibcamera_1_1ipa_1_1CameraSensorHelper_1_1AnalogueGainExp}{Analogue\+Gain\+Exp}}
\begin{DoxyCompactList}\small\item\em Analogue gain constants for the exponential gain model. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structlibcamera_1_1ipa_1_1CameraSensorHelper_1_1AnalogueGainLinear}{Analogue\+Gain\+Linear}}
\begin{DoxyCompactList}\small\item\em Analogue gain constants for the linear gain model. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae5e05b95f37bb7bec22bc805bda51589}{Camera\+Sensor\+Helper}} ()=default
\begin{DoxyCompactList}\small\item\em Construct a \doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper}{Camera\+Sensor\+Helper} instance. \end{DoxyCompactList}\item 
std\+::optional$<$ int16\+\_\+t $>$ \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_ad6d462fc5828e841563289eef22d3174}{black\+Level}} () const
\begin{DoxyCompactList}\small\item\em Fetch the black level of the sensor. \end{DoxyCompactList}\item 
virtual uint32\+\_\+t \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_a5c3fd0e1267fb455ba23ec3f1a96c41b}{gain\+Code}} (double \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae443ef2db6e3e5087cbb2fcd210b330b}{gain}}) const
\begin{DoxyCompactList}\small\item\em Compute gain code from the analogue gain absolute value. \end{DoxyCompactList}\item 
virtual double \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae443ef2db6e3e5087cbb2fcd210b330b}{gain}} (uint32\+\_\+t \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_a5c3fd0e1267fb455ba23ec3f1a96c41b}{gain\+Code}}) const
\begin{DoxyCompactList}\small\item\em Compute the real gain from the V4\+L2 subdev control gain code. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::optional$<$ int16\+\_\+t $>$ \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_a44159cca9daade1411af09dcf01c511f}{black\+Level\+\_\+}}
\begin{DoxyCompactList}\small\item\em The black level of the sensor. \end{DoxyCompactList}\item 
std\+::variant$<$ std\+::monostate, \mbox{\hyperlink{structlibcamera_1_1ipa_1_1CameraSensorHelper_1_1AnalogueGainLinear}{Analogue\+Gain\+Linear}}, \mbox{\hyperlink{structlibcamera_1_1ipa_1_1CameraSensorHelper_1_1AnalogueGainExp}{Analogue\+Gain\+Exp}} $>$ \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelper_a2db54f4af15e9442b16294b7f6d10a7b}{gain\+\_\+}}
\begin{DoxyCompactList}\small\item\em The analogue gain parameters used for calculation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class for computing sensor tuning parameters using sensor-\/specific constants. 

Instances derived from \doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper}{Camera\+Sensor\+Helper} class are sensor-\/specific. Each supported sensor will have an associated base class defined. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae5e05b95f37bb7bec22bc805bda51589}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae5e05b95f37bb7bec22bc805bda51589} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!CameraSensorHelper@{CameraSensorHelper}}
\index{CameraSensorHelper@{CameraSensorHelper}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{CameraSensorHelper()}{CameraSensorHelper()}}
{\footnotesize\ttfamily libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::\+Camera\+Sensor\+Helper (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



Construct a \doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper}{Camera\+Sensor\+Helper} instance. 

\doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper}{Camera\+Sensor\+Helper} derived class instances shall never be constructed manually but always through the \doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelperFactoryBase_a5ba8184bb2edf7858c72ed265f10145f}{Camera\+Sensor\+Helper\+Factory\+Base\+::create()} function. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_ad6d462fc5828e841563289eef22d3174}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_ad6d462fc5828e841563289eef22d3174} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!blackLevel@{blackLevel}}
\index{blackLevel@{blackLevel}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{blackLevel()}{blackLevel()}}
{\footnotesize\ttfamily libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::black\+Level (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Fetch the black level of the sensor. 

This function returns the black level of the sensor scaled to a 16bit pixel width. If it is unknown an empty optional is returned.

\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000007}{Todo}}]Fill the blanks and add pedestal values for all supported sensors. Once done, drop the std\+::optional$<$$>$.\end{DoxyRefDesc}


Black levels are typically the result of the following phenomena\+:
\begin{DoxyItemize}
\item Pedestal added by the sensor to pixel values. They are typically fixed, sometimes programmable and should be reported in datasheets (but documentation is not always available).
\item Dark currents and other physical effects that add charge to pixels in the absence of light. Those can depend on the integration time and the sensor die temperature, and their contribution to pixel values depend on the sensor gains.
\end{DoxyItemize}

The pedestal is usually the value with the biggest contribution to the overall black level. In most cases it is either known before or in rare cases (there is not a single driver with such a control in the linux kernel) can be queried from the sensor. This function provides that fixed, known value.

\begin{DoxyReturn}{Returns}
The black level of the sensor, or std\+::nullopt if not known 
\end{DoxyReturn}
\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae443ef2db6e3e5087cbb2fcd210b330b}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_ae443ef2db6e3e5087cbb2fcd210b330b} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!gain@{gain}}
\index{gain@{gain}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{gain()}{gain()}}
{\footnotesize\ttfamily double libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::gain (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{gain\+Code }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Compute the real gain from the V4\+L2 subdev control gain code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em gain\+Code} & The V4\+L2 subdev control gain\\
\hline
\end{DoxyParams}
This function aims to abstract the calculation of the gain letting the IPA use the real gain for its estimations. It is the counterpart of the function \doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper_a5c3fd0e1267fb455ba23ec3f1a96c41b}{Camera\+Sensor\+Helper\+::gain\+Code}.

\begin{DoxyReturn}{Returns}
The real gain 
\end{DoxyReturn}


Reimplemented in \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelperAr0144_abcfdd66a9812688b986aa61d12971c63}{libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+Ar0144}}, and \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelperAr0521_afbec85d8f351990dc0e4fff30a479d56}{libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+Ar0521}}.

\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_a5c3fd0e1267fb455ba23ec3f1a96c41b}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_a5c3fd0e1267fb455ba23ec3f1a96c41b} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!gainCode@{gainCode}}
\index{gainCode@{gainCode}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{gainCode()}{gainCode()}}
{\footnotesize\ttfamily uint32\+\_\+t libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::gain\+Code (\begin{DoxyParamCaption}\item[{double}]{gain }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Compute gain code from the analogue gain absolute value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em gain} & The real gain to pass\\
\hline
\end{DoxyParams}
This function aims to abstract the calculation of the gain letting the IPA use the real gain for its estimations.

\begin{DoxyReturn}{Returns}
The gain code to pass to V4\+L2 
\end{DoxyReturn}


Reimplemented in \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelperAr0144_abcdb5bd7aba474b921a815f5d0842a20}{libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+Ar0144}}, and \mbox{\hyperlink{classlibcamera_1_1ipa_1_1CameraSensorHelperAr0521_a58abcabd89fa7ecb93065c85923555bf}{libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+Ar0521}}.



\doxysubsection{Member Data Documentation}
\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_a44159cca9daade1411af09dcf01c511f}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_a44159cca9daade1411af09dcf01c511f} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!blackLevel\_@{blackLevel\_}}
\index{blackLevel\_@{blackLevel\_}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{blackLevel\_}{blackLevel\_}}
{\footnotesize\ttfamily libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::black\+Level\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}



The black level of the sensor. 

\begin{DoxySeeAlso}{See also}
\doxylink{classlibcamera_1_1ipa_1_1CameraSensorHelper_ad6d462fc5828e841563289eef22d3174}{Camera\+Sensor\+Helper\+::black\+Level()} 
\end{DoxySeeAlso}
\Hypertarget{classlibcamera_1_1ipa_1_1CameraSensorHelper_a2db54f4af15e9442b16294b7f6d10a7b}\label{classlibcamera_1_1ipa_1_1CameraSensorHelper_a2db54f4af15e9442b16294b7f6d10a7b} 
\index{libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}!gain\_@{gain\_}}
\index{gain\_@{gain\_}!libcamera::ipa::CameraSensorHelper@{libcamera::ipa::CameraSensorHelper}}
\doxysubsubsection{\texorpdfstring{gain\_}{gain\_}}
{\footnotesize\ttfamily libcamera\+::ipa\+::\+Camera\+Sensor\+Helper\+::gain\+\_\+\hspace{0.3cm}{\ttfamily [protected]}}



The analogue gain parameters used for calculation. 

The analogue gain is calculated through a formula, and its parameters are sensor specific. Use this variable to store the values at init time. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/peripherals/camera/libcamera/src/ipa/libipa/\mbox{\hyperlink{camera__sensor__helper_8h}{camera\+\_\+sensor\+\_\+helper.\+h}}\item 
src/peripherals/camera/libcamera/src/ipa/libipa/camera\+\_\+sensor\+\_\+helper.\+cpp\end{DoxyCompactItemize}
