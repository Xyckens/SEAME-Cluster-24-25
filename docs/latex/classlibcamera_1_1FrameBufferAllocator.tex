\doxysection{libcamera\+::Frame\+Buffer\+Allocator Class Reference}
\hypertarget{classlibcamera_1_1FrameBufferAllocator}{}\label{classlibcamera_1_1FrameBufferAllocator}\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}


\doxylink{classlibcamera_1_1FrameBuffer}{Frame\+Buffer} allocator for applications.  


\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classlibcamera_1_1FrameBufferAllocator_ab66590d49bdb5dba848a74604f0b2597}{Frame\+Buffer\+Allocator}} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classlibcamera_1_1Camera}{Camera}} $>$ camera)
\begin{DoxyCompactList}\small\item\em Construct a \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} serving a camera. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a}{allocate}} (\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}stream)
\begin{DoxyCompactList}\small\item\em Allocate buffers for a configured stream. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classlibcamera_1_1FrameBufferAllocator_a184749ea64aeba195bd7c8a880311cd4}{free}} (\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}stream)
\begin{DoxyCompactList}\small\item\em Free buffers previously allocated for a {\itshape stream}. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classlibcamera_1_1FrameBufferAllocator_a9931b9d499b2d72287129aaa0d6f9fd7}{allocated}} () const
\begin{DoxyCompactList}\small\item\em Check if the allocator has allocated buffers for any stream. \end{DoxyCompactList}\item 
const std\+::vector$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classlibcamera_1_1FrameBuffer}{Frame\+Buffer}} $>$ $>$ \& \mbox{\hyperlink{classlibcamera_1_1FrameBufferAllocator_a8207ce42ed29ebae26378357c2054ee7}{buffers}} (\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}stream) const
\begin{DoxyCompactList}\small\item\em Retrieve the buffers allocated for a {\itshape stream}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxylink{classlibcamera_1_1FrameBuffer}{Frame\+Buffer} allocator for applications. 

The libcamera API is designed to consume buffers provided by applications as \doxylink{classlibcamera_1_1FrameBuffer}{Frame\+Buffer} instances. This makes libcamera a user of buffers exported by other devices (such as displays or video encoders), or allocated from an external allocator (such as ION on Android platforms). In some situations, applications do not have any means to allocate or get hold of suitable buffers, for instance when no other device is involved, on Linux platforms that lack a centralized allocator. The \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} class provides a buffer allocator that can be used in these situations.

Applications create a framebuffer allocator for a \doxylink{classlibcamera_1_1Camera}{Camera}, and use it to allocate buffers for streams of a \doxylink{classlibcamera_1_1CameraConfiguration}{Camera\+Configuration} with \doxylink{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a}{allocate()}. They control which streams to allocate buffers for, and can thus use external buffers for a subset of the streams if desired.

Buffers are deleted for a stream with \doxylink{classlibcamera_1_1FrameBufferAllocator_a184749ea64aeba195bd7c8a880311cd4}{free()}, and destroying the allocator automatically deletes all allocated buffers. Applications own the buffers allocated by the \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} and are responsible for ensuring the buffers are not deleted while they are in use (part of a \doxylink{classlibcamera_1_1Request}{Request} that has been queued and hasn\textquotesingle{}t completed yet).

Usage of the \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} is optional, if all buffers for a camera are provided externally applications shall not use this class. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classlibcamera_1_1FrameBufferAllocator_ab66590d49bdb5dba848a74604f0b2597}\label{classlibcamera_1_1FrameBufferAllocator_ab66590d49bdb5dba848a74604f0b2597} 
\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}!FrameBufferAllocator@{FrameBufferAllocator}}
\index{FrameBufferAllocator@{FrameBufferAllocator}!libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}
\doxysubsubsection{\texorpdfstring{FrameBufferAllocator()}{FrameBufferAllocator()}}
{\footnotesize\ttfamily libcamera\+::\+Frame\+Buffer\+Allocator\+::\+Frame\+Buffer\+Allocator (\begin{DoxyParamCaption}\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classlibcamera_1_1Camera}{Camera}} $>$}]{camera }\end{DoxyParamCaption})}



Construct a \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} serving a camera. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em camera} & The camera \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a}\label{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a} 
\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}!allocate@{allocate}}
\index{allocate@{allocate}!libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}
\doxysubsubsection{\texorpdfstring{allocate()}{allocate()}}
{\footnotesize\ttfamily int libcamera\+::\+Frame\+Buffer\+Allocator\+::allocate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}}]{stream }\end{DoxyParamCaption})}



Allocate buffers for a configured stream. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em stream} & The stream to allocate buffers for\\
\hline
\end{DoxyParams}
Allocate buffers suitable for capturing frames from the {\itshape stream}. The \doxylink{classlibcamera_1_1Camera}{Camera} shall have been previously configured with \doxylink{classlibcamera_1_1Camera_a4c190f4c369628e5cd96770790559a26}{Camera\+::configure()} and shall be stopped, and the stream shall be part of the active camera configuration.

Upon successful allocation, the allocated buffers can be retrieved with the \doxylink{classlibcamera_1_1FrameBufferAllocator_a8207ce42ed29ebae26378357c2054ee7}{buffers()} function.

\begin{DoxyReturn}{Returns}
The number of allocated buffers on success or a negative error code otherwise 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em -\/\+EACCES} & The camera is not in a state where buffers can be allocated \\
\hline
{\em -\/\+EINVAL} & The {\itshape stream} does not belong to the camera or the stream is not part of the active camera configuration \\
\hline
{\em -\/\+EBUSY} & Buffers are already allocated for the {\itshape stream} \\
\hline
\end{DoxyRetVals}
\Hypertarget{classlibcamera_1_1FrameBufferAllocator_a9931b9d499b2d72287129aaa0d6f9fd7}\label{classlibcamera_1_1FrameBufferAllocator_a9931b9d499b2d72287129aaa0d6f9fd7} 
\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}!allocated@{allocated}}
\index{allocated@{allocated}!libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}
\doxysubsubsection{\texorpdfstring{allocated()}{allocated()}}
{\footnotesize\ttfamily libcamera\+::\+Frame\+Buffer\+Allocator\+::allocated (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Check if the allocator has allocated buffers for any stream. 

\begin{DoxyReturn}{Returns}
True if the allocator has allocated buffers for one or more streams, false otherwise 
\end{DoxyReturn}
\Hypertarget{classlibcamera_1_1FrameBufferAllocator_a8207ce42ed29ebae26378357c2054ee7}\label{classlibcamera_1_1FrameBufferAllocator_a8207ce42ed29ebae26378357c2054ee7} 
\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}!buffers@{buffers}}
\index{buffers@{buffers}!libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}
\doxysubsubsection{\texorpdfstring{buffers()}{buffers()}}
{\footnotesize\ttfamily const std\+::vector$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classlibcamera_1_1FrameBuffer}{Frame\+Buffer}} $>$ $>$ \& libcamera\+::\+Frame\+Buffer\+Allocator\+::buffers (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}}]{stream }\end{DoxyParamCaption}) const}



Retrieve the buffers allocated for a {\itshape stream}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em stream} & The stream to retrieve buffers for\\
\hline
\end{DoxyParams}
This function shall only be called after successfully allocating buffers for {\itshape stream} with \doxylink{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a}{allocate()}. The returned buffers are valid until \doxylink{classlibcamera_1_1FrameBufferAllocator_a184749ea64aeba195bd7c8a880311cd4}{free()} is called for the same stream or the \doxylink{classlibcamera_1_1FrameBufferAllocator}{Frame\+Buffer\+Allocator} instance is destroyed.

\begin{DoxyReturn}{Returns}
The buffers allocated for the {\itshape stream} 
\end{DoxyReturn}
\Hypertarget{classlibcamera_1_1FrameBufferAllocator_a184749ea64aeba195bd7c8a880311cd4}\label{classlibcamera_1_1FrameBufferAllocator_a184749ea64aeba195bd7c8a880311cd4} 
\index{libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}!free@{free}}
\index{free@{free}!libcamera::FrameBufferAllocator@{libcamera::FrameBufferAllocator}}
\doxysubsubsection{\texorpdfstring{free()}{free()}}
{\footnotesize\ttfamily int libcamera\+::\+Frame\+Buffer\+Allocator\+::free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classlibcamera_1_1Stream}{Stream}} \texorpdfstring{$\ast$}{*}}]{stream }\end{DoxyParamCaption})}



Free buffers previously allocated for a {\itshape stream}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em stream} & The stream\\
\hline
\end{DoxyParams}
Free buffers allocated with \doxylink{classlibcamera_1_1FrameBufferAllocator_a1d115534f49614e3466f5e86fbc43f2a}{allocate()}.

This invalidates the buffers returned by \doxylink{classlibcamera_1_1FrameBufferAllocator_a8207ce42ed29ebae26378357c2054ee7}{buffers()}.

\begin{DoxyReturn}{Returns}
0 on success or a negative error code otherwise 
\end{DoxyReturn}

\begin{DoxyRetVals}{Return values}
{\em -\/\+EACCES} & The camera is not in a state where buffers can be freed \\
\hline
{\em -\/\+EINVAL} & The allocator do not handle the {\itshape stream} \\
\hline
\end{DoxyRetVals}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/peripherals/camera/libcamera/include/libcamera/\mbox{\hyperlink{framebuffer__allocator_8h}{framebuffer\+\_\+allocator.\+h}}\item 
src/peripherals/camera/libcamera/src/libcamera/framebuffer\+\_\+allocator.\+cpp\end{DoxyCompactItemize}
