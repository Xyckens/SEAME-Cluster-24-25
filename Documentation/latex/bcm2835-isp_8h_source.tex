\doxysection{bcm2835-\/isp.h}
\hypertarget{bcm2835-isp_8h_source}{}\label{bcm2835-isp_8h_source}\index{src/peripherals/camera/libcamera/include/linux/bcm2835-\/isp.h@{src/peripherals/camera/libcamera/include/linux/bcm2835-\/isp.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*\ SPDX-\/License-\/Identifier:\ ((GPL-\/2.0+\ WITH\ Linux-\/syscall-\/note)\ OR\ BSD-\/3-\/Clause)\ */}}
\DoxyCodeLine{00002\ \textcolor{comment}{/*}}
\DoxyCodeLine{00003\ \textcolor{comment}{\ *\ bcm2835-\/isp.h}}
\DoxyCodeLine{00004\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00005\ \textcolor{comment}{\ *\ BCM2835\ ISP\ driver\ -\/\ user\ space\ header\ file.}}
\DoxyCodeLine{00006\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00007\ \textcolor{comment}{\ *\ Copyright\ Â©\ 2019-\/2020\ Raspberry\ Pi\ Ltd}}
\DoxyCodeLine{00008\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00009\ \textcolor{comment}{\ *\ Author:\ Naushir\ Patuck\ (naush@raspberrypi.com)}}
\DoxyCodeLine{00010\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00011\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ \_\_BCM2835\_ISP\_H\_}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ \_\_BCM2835\_ISP\_H\_}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <linux/v4l2-\/controls.h>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_CC\_MATRIX\ \(\backslash\)}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0001)}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_LENS\_SHADING\ \ \(\backslash\)}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0002)}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_BLACK\_LEVEL\ \ \ \(\backslash\)}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0003)}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_GEQ\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0004)}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_GAMMA\ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0005)}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_DENOISE\ \ \ \(\backslash\)}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0006)}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_SHARPEN\ \ \ \(\backslash\)}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0007)}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_DPC\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0008)}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ V4L2\_CID\_USER\_BCM2835\_ISP\_CDN\ \(\backslash\)}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (V4L2\_CID\_USER\_BCM2835\_ISP\_BASE\ +\ 0x0009)}}
\DoxyCodeLine{00036\ \textcolor{comment}{/*}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ *\ All\ structs\ below\ are\ directly\ mapped\ onto\ the\ equivalent\ structs\ in}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ *\ drivers/staging/vc04\_services/vchiq-\/mmal/mmal-\/parameters.h}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ *\ for\ convenience.}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \_\_s32\ num;}
\DoxyCodeLine{00050\ \ \ \ \ \_\_u32\ den;}
\DoxyCodeLine{00051\ \};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__ccm}{bcm2835\_isp\_ccm}}\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ ccm[3][3];}
\DoxyCodeLine{00061\ \ \ \ \ \_\_s32\ offsets[3];}
\DoxyCodeLine{00062\ \};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00071\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__custom__ccm}{bcm2835\_isp\_custom\_ccm}}\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__ccm}{bcm2835\_isp\_ccm}}\ ccm;}
\DoxyCodeLine{00074\ \};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{enum}\ bcm2835\_isp\_gain\_format\ \{}
\DoxyCodeLine{00091\ \ \ \ \ GAIN\_FORMAT\_U0P8\_1\ =\ 0,}
\DoxyCodeLine{00092\ \ \ \ \ GAIN\_FORMAT\_U1P7\_0\ =\ 1,}
\DoxyCodeLine{00093\ \ \ \ \ GAIN\_FORMAT\_U1P7\_1\ =\ 2,}
\DoxyCodeLine{00094\ \ \ \ \ GAIN\_FORMAT\_U2P6\_0\ =\ 3,}
\DoxyCodeLine{00095\ \ \ \ \ GAIN\_FORMAT\_U2P6\_1\ =\ 4,}
\DoxyCodeLine{00096\ \ \ \ \ GAIN\_FORMAT\_U3P5\_0\ =\ 5,}
\DoxyCodeLine{00097\ \ \ \ \ GAIN\_FORMAT\_U3P5\_1\ =\ 6,}
\DoxyCodeLine{00098\ \ \ \ \ GAIN\_FORMAT\_U4P10\ \ =\ 7,}
\DoxyCodeLine{00099\ \};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__lens__shading}{bcm2835\_isp\_lens\_shading}}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00120\ \ \ \ \ \_\_u32\ grid\_cell\_size;}
\DoxyCodeLine{00121\ \ \ \ \ \_\_u32\ grid\_width;}
\DoxyCodeLine{00122\ \ \ \ \ \_\_u32\ grid\_stride;}
\DoxyCodeLine{00123\ \ \ \ \ \_\_u32\ grid\_height;}
\DoxyCodeLine{00124\ \ \ \ \ \_\_s32\ dmabuf;}
\DoxyCodeLine{00125\ \ \ \ \ \_\_u32\ ref\_transform;}
\DoxyCodeLine{00126\ \ \ \ \ \_\_u32\ corner\_sampled;}
\DoxyCodeLine{00127\ \ \ \ \ \_\_u32\ gain\_format;}
\DoxyCodeLine{00128\ \};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00139\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__black__level}{bcm2835\_isp\_black\_level}}\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00141\ \ \ \ \ \_\_u16\ black\_level\_r;}
\DoxyCodeLine{00142\ \ \ \ \ \_\_u16\ black\_level\_g;}
\DoxyCodeLine{00143\ \ \ \ \ \_\_u16\ black\_level\_b;}
\DoxyCodeLine{00144\ \ \ \ \ \_\_u8\ padding[2];\ \textcolor{comment}{/*\ Unused\ */}}
\DoxyCodeLine{00145\ \};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__geq}{bcm2835\_isp\_geq}}\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00157\ \ \ \ \ \_\_u32\ offset;}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ slope;}
\DoxyCodeLine{00159\ \};}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{preprocessor}{\#define\ BCM2835\_NUM\_GAMMA\_PTS\ 33}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00173\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__gamma}{bcm2835\_isp\_gamma}}\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00175\ \ \ \ \ \_\_u16\ x[BCM2835\_NUM\_GAMMA\_PTS];}
\DoxyCodeLine{00176\ \ \ \ \ \_\_u16\ y[BCM2835\_NUM\_GAMMA\_PTS];}
\DoxyCodeLine{00177\ \};}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{enum}\ bcm2835\_isp\_cdn\_mode\ \{}
\DoxyCodeLine{00188\ \ \ \ \ CDN\_MODE\_FAST\ =\ 0,}
\DoxyCodeLine{00189\ \ \ \ \ CDN\_MODE\_HIGH\_QUALITY\ =\ 1,}
\DoxyCodeLine{00190\ \};}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00199\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__cdn}{bcm2835\_isp\_cdn}}\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00201\ \ \ \ \ \_\_u32\ mode;}
\DoxyCodeLine{00202\ \};}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00213\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__denoise}{bcm2835\_isp\_denoise}}\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00215\ \ \ \ \ \_\_u32\ constant;}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ slope;}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ strength;}
\DoxyCodeLine{00218\ \};}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00229\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__sharpen}{bcm2835\_isp\_sharpen}}\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ threshold;}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ strength;}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__rational}{bcm2835\_isp\_rational}}\ limit;}
\DoxyCodeLine{00234\ \};}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00243\ \textcolor{keyword}{enum}\ bcm2835\_isp\_dpc\_mode\ \{}
\DoxyCodeLine{00244\ \ \ \ \ DPC\_MODE\_OFF\ =\ 0,}
\DoxyCodeLine{00245\ \ \ \ \ DPC\_MODE\_NORMAL\ =\ 1,}
\DoxyCodeLine{00246\ \ \ \ \ DPC\_MODE\_STRONG\ =\ 2,}
\DoxyCodeLine{00247\ \};}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00256\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__dpc}{bcm2835\_isp\_dpc}}\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \_\_u32\ enabled;}
\DoxyCodeLine{00258\ \ \ \ \ \_\_u32\ strength;}
\DoxyCodeLine{00259\ \};}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \textcolor{comment}{/*}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ *\ ISP\ statistics\ structures.}}
\DoxyCodeLine{00263\ \textcolor{comment}{\ *}}
\DoxyCodeLine{00264\ \textcolor{comment}{\ *\ The\ bcm2835\_isp\_stats\ structure\ is\ generated\ at\ the\ output\ of\ the}}
\DoxyCodeLine{00265\ \textcolor{comment}{\ *\ statistics\ node.\ \ Note\ that\ this\ does\ not\ directly\ map\ onto\ the\ statistics}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ *\ output\ of\ the\ ISP\ HW.\ \ Instead,\ the\ MMAL\ firmware\ code\ maps\ the\ HW\ statistics}}
\DoxyCodeLine{00267\ \textcolor{comment}{\ *\ to\ the\ bcm2835\_isp\_stats\ structure.}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00269\ \textcolor{preprocessor}{\#define\ DEFAULT\_AWB\_REGIONS\_X\ 16}}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\#define\ DEFAULT\_AWB\_REGIONS\_Y\ 12}}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \textcolor{preprocessor}{\#define\ NUM\_HISTOGRAMS\ 2}}
\DoxyCodeLine{00273\ \textcolor{preprocessor}{\#define\ NUM\_HISTOGRAM\_BINS\ 128}}
\DoxyCodeLine{00274\ \textcolor{preprocessor}{\#define\ AWB\_REGIONS\ (DEFAULT\_AWB\_REGIONS\_X\ *\ DEFAULT\_AWB\_REGIONS\_Y)}}
\DoxyCodeLine{00275\ \textcolor{preprocessor}{\#define\ FLOATING\_REGIONS\ 16}}
\DoxyCodeLine{00276\ \textcolor{preprocessor}{\#define\ AGC\_REGIONS\ 16}}
\DoxyCodeLine{00277\ \textcolor{preprocessor}{\#define\ FOCUS\_REGIONS\ 12}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00286\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__hist}{bcm2835\_isp\_stats\_hist}}\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \_\_u32\ r\_hist[NUM\_HISTOGRAM\_BINS];}
\DoxyCodeLine{00288\ \ \ \ \ \_\_u32\ g\_hist[NUM\_HISTOGRAM\_BINS];}
\DoxyCodeLine{00289\ \ \ \ \ \_\_u32\ b\_hist[NUM\_HISTOGRAM\_BINS];}
\DoxyCodeLine{00290\ \};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00301\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__region}{bcm2835\_isp\_stats\_region}}\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \_\_u32\ counted;}
\DoxyCodeLine{00303\ \ \ \ \ \_\_u32\ notcounted;}
\DoxyCodeLine{00304\ \ \ \ \ \_\_u64\ r\_sum;}
\DoxyCodeLine{00305\ \ \ \ \ \_\_u64\ g\_sum;}
\DoxyCodeLine{00306\ \ \ \ \ \_\_u64\ b\_sum;}
\DoxyCodeLine{00307\ \};}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00320\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__focus}{bcm2835\_isp\_stats\_focus}}\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \_\_u64\ contrast\_val[2][2];}
\DoxyCodeLine{00322\ \ \ \ \ \_\_u32\ contrast\_val\_num[2][2];}
\DoxyCodeLine{00323\ \};}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00336\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats}{bcm2835\_isp\_stats}}\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \_\_u32\ version;}
\DoxyCodeLine{00338\ \ \ \ \ \_\_u32\ size;}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__hist}{bcm2835\_isp\_stats\_hist}}\ hist[NUM\_HISTOGRAMS];}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__region}{bcm2835\_isp\_stats\_region}}\ awb\_stats[AWB\_REGIONS];}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__region}{bcm2835\_isp\_stats\_region}}\ floating\_stats[FLOATING\_REGIONS];}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__region}{bcm2835\_isp\_stats\_region}}\ agc\_stats[AGC\_REGIONS];}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structbcm2835__isp__stats__focus}{bcm2835\_isp\_stats\_focus}}\ focus\_stats[FOCUS\_REGIONS];}
\DoxyCodeLine{00344\ \};}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ \_\_BCM2835\_ISP\_H\_\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
