<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JetPackJoyRide: libcamera::ipa::ipu3::IPAIPU3 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">JetPackJoyRide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibcamera.html">libcamera</a></li><li class="navelem"><a class="el" href="namespacelibcamera_1_1ipa.html">ipa</a></li><li class="navelem"><b>ipu3</b></li><li class="navelem"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html">IPAIPU3</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libcamera::ipa::ipu3::IPAIPU3 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The IPU3 IPA implementation.  
 <a href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for libcamera::ipa::ipu3::IPAIPU3:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.png" usemap="#libcamera::ipa::ipu3::IPAIPU3_map" alt=""/>
  <map id="libcamera::ipa::ipu3::IPAIPU3_map" name="libcamera::ipa::ipu3::IPAIPU3_map">
<area href="classlibcamera_1_1ipa_1_1Module.html" title="The base class for all IPA modules." alt="libcamera::ipa::Module&lt; _Context, _FrameContext, _Config, _Params, _Stats &gt;" shape="rect" coords="657,56,1304,80"/>
<area href="classlibcamera_1_1Loggable.html" title="Base class to support log message extensions." alt="libcamera::Loggable" shape="rect" coords="657,0,1304,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad8a1e0258a32c0c98feb4d8e6e9e9b3f" id="r_ad8a1e0258a32c0c98feb4d8e6e9e9b3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#ad8a1e0258a32c0c98feb4d8e6e9e9b3f">init</a> (const IPASettings &amp;settings, const IPACameraSensorInfo &amp;sensorInfo, const <a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> &amp;sensorControls, <a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> *ipaControls) override</td></tr>
<tr class="memdesc:ad8a1e0258a32c0c98feb4d8e6e9e9b3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the IPA module and its controls.  <br /></td></tr>
<tr class="separator:ad8a1e0258a32c0c98feb4d8e6e9e9b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823bb09efe22da059faba5272bb40265" id="r_a823bb09efe22da059faba5272bb40265"><td class="memItemLeft" align="right" valign="top"><a id="a823bb09efe22da059faba5272bb40265" name="a823bb09efe22da059faba5272bb40265"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>start</b> () override</td></tr>
<tr class="memdesc:a823bb09efe22da059faba5272bb40265"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform any processing required before the first frame. <br /></td></tr>
<tr class="separator:a823bb09efe22da059faba5272bb40265"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7356d22982ea9014b227daa6d8b9e09" id="r_aa7356d22982ea9014b227daa6d8b9e09"><td class="memItemLeft" align="right" valign="top"><a id="aa7356d22982ea9014b227daa6d8b9e09" name="aa7356d22982ea9014b227daa6d8b9e09"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>stop</b> () override</td></tr>
<tr class="memdesc:aa7356d22982ea9014b227daa6d8b9e09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure that all processing has completed. <br /></td></tr>
<tr class="separator:aa7356d22982ea9014b227daa6d8b9e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9206f03f723d4eaedc61de71d44b311b" id="r_a9206f03f723d4eaedc61de71d44b311b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a9206f03f723d4eaedc61de71d44b311b">configure</a> (const IPAConfigInfo &amp;configInfo, <a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> *ipaControls) override</td></tr>
<tr class="memdesc:a9206f03f723d4eaedc61de71d44b311b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the IPU3 IPA.  <br /></td></tr>
<tr class="separator:a9206f03f723d4eaedc61de71d44b311b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9f197dc13f318948d281cf748516c2" id="r_a3b9f197dc13f318948d281cf748516c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a3b9f197dc13f318948d281cf748516c2">mapBuffers</a> (const std::vector&lt; IPABuffer &gt; &amp;buffers) override</td></tr>
<tr class="memdesc:a3b9f197dc13f318948d281cf748516c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map the parameters and stats buffers allocated in the pipeline handler.  <br /></td></tr>
<tr class="separator:a3b9f197dc13f318948d281cf748516c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff233cece46b9bc1e29d43b41a95772" id="r_abff233cece46b9bc1e29d43b41a95772"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#abff233cece46b9bc1e29d43b41a95772">unmapBuffers</a> (const std::vector&lt; unsigned int &gt; &amp;ids) override</td></tr>
<tr class="memdesc:abff233cece46b9bc1e29d43b41a95772"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmap the parameters and stats buffers.  <br /></td></tr>
<tr class="separator:abff233cece46b9bc1e29d43b41a95772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fc0c8bfda49cc125ef94e4476bd77ba" id="r_a1fc0c8bfda49cc125ef94e4476bd77ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a1fc0c8bfda49cc125ef94e4476bd77ba">queueRequest</a> (const uint32_t frame, const <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;controls) override</td></tr>
<tr class="memdesc:a1fc0c8bfda49cc125ef94e4476bd77ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue a request and process the control list from the application.  <br /></td></tr>
<tr class="separator:a1fc0c8bfda49cc125ef94e4476bd77ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba550913c07929582a9b6d367064ac5c" id="r_aba550913c07929582a9b6d367064ac5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#aba550913c07929582a9b6d367064ac5c">computeParams</a> (const uint32_t frame, const uint32_t bufferId) override</td></tr>
<tr class="memdesc:aba550913c07929582a9b6d367064ac5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill and return a buffer with ISP processing parameters for a frame.  <br /></td></tr>
<tr class="separator:aba550913c07929582a9b6d367064ac5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501e3d74a9ddfc6fa0fb8a42dd85d5b4" id="r_a501e3d74a9ddfc6fa0fb8a42dd85d5b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a501e3d74a9ddfc6fa0fb8a42dd85d5b4">processStats</a> (const uint32_t frame, const int64_t frameTimestamp, const uint32_t bufferId, const <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;sensorControls) override</td></tr>
<tr class="memdesc:a501e3d74a9ddfc6fa0fb8a42dd85d5b4"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlibcamera_1_1Process.html" title="Process object.">Process</a> the statistics generated by the ImgU.  <br /></td></tr>
<tr class="separator:a501e3d74a9ddfc6fa0fb8a42dd85d5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlibcamera_1_1ipa_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlibcamera_1_1ipa_1_1Module')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlibcamera_1_1ipa_1_1Module.html">libcamera::ipa::Module&lt; _Context, _FrameContext, _Config, _Params, _Stats &gt;</a></td></tr>
<tr class="memitem:a99862ac2546d99418f1ac826af38c32a inherit pub_methods_classlibcamera_1_1ipa_1_1Module" id="r_a99862ac2546d99418f1ac826af38c32a"><td class="memItemLeft" align="right" valign="top">const std::list&lt; std::unique_ptr&lt; <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html">Algorithm</a>&lt; <a class="el" href="classlibcamera_1_1ipa_1_1Module.html">Module</a> &gt; &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a99862ac2546d99418f1ac826af38c32a">algorithms</a> () const</td></tr>
<tr class="memdesc:a99862ac2546d99418f1ac826af38c32a inherit pub_methods_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the list of instantiated algorithms.  <br /></td></tr>
<tr class="separator:a99862ac2546d99418f1ac826af38c32a inherit pub_methods_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc951fcbe0b8e25594abba03aa0f7d0 inherit pub_methods_classlibcamera_1_1ipa_1_1Module" id="r_acbc951fcbe0b8e25594abba03aa0f7d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Module.html#acbc951fcbe0b8e25594abba03aa0f7d0">createAlgorithms</a> (<a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Context</a> &amp;context, const <a class="el" href="classlibcamera_1_1YamlObject.html">YamlObject</a> &amp;<a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a99862ac2546d99418f1ac826af38c32a">algorithms</a>)</td></tr>
<tr class="memdesc:acbc951fcbe0b8e25594abba03aa0f7d0 inherit pub_methods_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create algorithms from YAML configuration data.  <br /></td></tr>
<tr class="separator:acbc951fcbe0b8e25594abba03aa0f7d0 inherit pub_methods_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a7a4d547cc8ab9165e8149e62c3654f4f" id="r_a7a4d547cc8ab9165e8149e62c3654f4f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a7a4d547cc8ab9165e8149e62c3654f4f">logPrefix</a> () const override</td></tr>
<tr class="memdesc:a7a4d547cc8ab9165e8149e62c3654f4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a string to be prefixed to the log message.  <br /></td></tr>
<tr class="separator:a7a4d547cc8ab9165e8149e62c3654f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classlibcamera_1_1Loggable"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classlibcamera_1_1Loggable')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classlibcamera_1_1Loggable.html">libcamera::Loggable</a></td></tr>
<tr class="memitem:a56b00f844b75b5d08cad898ed9c6181e inherit pro_methods_classlibcamera_1_1Loggable" id="r_a56b00f844b75b5d08cad898ed9c6181e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibcamera_1_1LogMessage.html">LogMessage</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1Loggable.html#a56b00f844b75b5d08cad898ed9c6181e">_log</a> (const <a class="el" href="classlibcamera_1_1LogCategory.html">LogCategory</a> *category, <a class="el" href="namespacelibcamera.html#a68f26f5a54a5bb105f2e7422215a0ca3">LogSeverity</a> severity, const char *fileName=__builtin_FILE(), unsigned int line=__builtin_LINE()) const</td></tr>
<tr class="memdesc:a56b00f844b75b5d08cad898ed9c6181e inherit pro_methods_classlibcamera_1_1Loggable"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a temporary <a class="el" href="classlibcamera_1_1LogMessage.html" title="Internal log message representation.">LogMessage</a> object to log a message.  <br /></td></tr>
<tr class="separator:a56b00f844b75b5d08cad898ed9c6181e inherit pro_methods_classlibcamera_1_1Loggable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classlibcamera_1_1ipa_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classlibcamera_1_1ipa_1_1Module')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classlibcamera_1_1ipa_1_1Module.html">libcamera::ipa::Module&lt; _Context, _FrameContext, _Config, _Params, _Stats &gt;</a></td></tr>
<tr class="memitem:a2a12d05faa4f517f4dfcfa087063fd27 inherit pub_types_classlibcamera_1_1ipa_1_1Module" id="r_a2a12d05faa4f517f4dfcfa087063fd27"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>Context</b> = _Context</td></tr>
<tr class="memdesc:a2a12d05faa4f517f4dfcfa087063fd27 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the shared IPA context. <br /></td></tr>
<tr class="separator:a2a12d05faa4f517f4dfcfa087063fd27 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1bf7efd7811fb9da8ff311aeef3b1c inherit pub_types_classlibcamera_1_1ipa_1_1Module" id="r_a5a1bf7efd7811fb9da8ff311aeef3b1c"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>FrameContext</b> = _FrameContext</td></tr>
<tr class="memdesc:a5a1bf7efd7811fb9da8ff311aeef3b1c inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the frame context. <br /></td></tr>
<tr class="separator:a5a1bf7efd7811fb9da8ff311aeef3b1c inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0b7a42c526c07bafeca4018b38b8c9 inherit pub_types_classlibcamera_1_1ipa_1_1Module" id="r_a7c0b7a42c526c07bafeca4018b38b8c9"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>Config</b> = _Config</td></tr>
<tr class="memdesc:a7c0b7a42c526c07bafeca4018b38b8c9 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the IPA configuration data. <br /></td></tr>
<tr class="separator:a7c0b7a42c526c07bafeca4018b38b8c9 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ee62113eed1c9ad7a001887dc59674 inherit pub_types_classlibcamera_1_1ipa_1_1Module" id="r_a48ee62113eed1c9ad7a001887dc59674"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>Params</b> = _Params</td></tr>
<tr class="memdesc:a48ee62113eed1c9ad7a001887dc59674 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the ISP specific parameters. <br /></td></tr>
<tr class="separator:a48ee62113eed1c9ad7a001887dc59674 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdcea0695dc0eb1226d66442a5647a41 inherit pub_types_classlibcamera_1_1ipa_1_1Module" id="r_afdcea0695dc0eb1226d66442a5647a41"><td class="memItemLeft" align="right" valign="top">
using&#160;</td><td class="memItemRight" valign="bottom"><b>Stats</b> = _Stats</td></tr>
<tr class="memdesc:afdcea0695dc0eb1226d66442a5647a41 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">The type of the IPA statistics and ISP results. <br /></td></tr>
<tr class="separator:afdcea0695dc0eb1226d66442a5647a41 inherit pub_types_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classlibcamera_1_1ipa_1_1Module"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classlibcamera_1_1ipa_1_1Module')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classlibcamera_1_1ipa_1_1Module.html">libcamera::ipa::Module&lt; _Context, _FrameContext, _Config, _Params, _Stats &gt;</a></td></tr>
<tr class="memitem:a62af12d353cea10272b2feb34671ef18 inherit pub_static_methods_classlibcamera_1_1ipa_1_1Module" id="r_a62af12d353cea10272b2feb34671ef18"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a62af12d353cea10272b2feb34671ef18">registerAlgorithm</a> (<a class="el" href="classlibcamera_1_1ipa_1_1AlgorithmFactoryBase.html">AlgorithmFactoryBase</a>&lt; <a class="el" href="classlibcamera_1_1ipa_1_1Module.html">Module</a> &gt; *factory)</td></tr>
<tr class="memdesc:a62af12d353cea10272b2feb34671ef18 inherit pub_static_methods_classlibcamera_1_1ipa_1_1Module"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an algorithm factory class to the list of available algorithms.  <br /></td></tr>
<tr class="separator:a62af12d353cea10272b2feb34671ef18 inherit pub_static_methods_classlibcamera_1_1ipa_1_1Module"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The IPU3 IPA implementation. </p>
<p>The IPU3 Pipeline defines an IPU3-specific interface for communication between the <a class="el" href="classlibcamera_1_1PipelineHandler.html" title="Create and manage cameras based on a set of media devices.">PipelineHandler</a> and the IPA module.</p>
<p>We extend the IPAIPU3Interface to implement our algorithms and handle calls from the IPU3 <a class="el" href="classlibcamera_1_1PipelineHandler.html" title="Create and manage cameras based on a set of media devices.">PipelineHandler</a> to satisfy requests from the application.</p>
<p>At initialisation time, a <a class="el" href="classlibcamera_1_1ipa_1_1CameraSensorHelper.html" title="Base class for computing sensor tuning parameters using sensor-specific constants.">CameraSensorHelper</a> is instantiated to support camera-specific calculations, while the default controls are computed, and the algorithms are instantiated from the tuning data file.</p>
<p>The IPU3 ImgU operates with a grid layout to divide the overall frame into rectangular cells of pixels. When the IPA is configured, we determine the best grid for the statistics based on the pipeline handler Bayer Down Scaler output size.</p>
<p>Two main events are then handled to operate the IPU3 ImgU by populating its parameter buffer, and adapting the settings of the sensor attached to the IPU3 CIO2 through sensor-specific V4L2 controls.</p>
<p>In <a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#aba550913c07929582a9b6d367064ac5c" title="Fill and return a buffer with ISP processing parameters for a frame.">computeParams()</a>, we populate the ImgU parameter buffer with settings to configure the device in preparation for handling the frame queued in the <a class="el" href="classlibcamera_1_1Request.html" title="A frame capture request.">Request</a>.</p>
<p>When the frame has completed processing, the ImgU will generate a statistics buffer which is given to the IPA with <a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#a501e3d74a9ddfc6fa0fb8a42dd85d5b4" title="Process the statistics generated by the ImgU.">processStats()</a>. In this we run the algorithms to parse the statistics and cache any results for the next <a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1IPAIPU3.html#aba550913c07929582a9b6d367064ac5c" title="Fill and return a buffer with ISP processing parameters for a frame.">computeParams()</a> call.</p>
<p>The individual algorithms are split into modular components that are called iteratively to allow them to process statistics from the ImgU in the order defined in the tuning data file.</p>
<p>The current implementation supports five core algorithms:</p>
<ul>
<li>Auto focus (AF)</li>
<li>Automatic gain and exposure control (AGC)</li>
<li>Automatic white balance (AWB)</li>
<li>Black level correction (BLC)</li>
<li>Tone mapping (Gamma)</li>
</ul>
<p>AWB is implemented using a Greyworld algorithm, and calculates the red and blue gains to apply to generate a neutral grey frame overall.</p>
<p>AGC is handled by calculating a histogram of the green channel to estimate an analogue gain and exposure time which will provide a well exposed frame. A low-pass IIR filter is used to smooth the changes to the sensor to reduce perceivable steps.</p>
<p>The tone mapping algorithm provides a gamma correction table to improve the contrast of the scene.</p>
<p>The black level compensation algorithm subtracts a hardcoded black level from all pixels.</p>
<p>The IPU3 ImgU has further processing blocks to support image quality improvements through bayer and temporal noise reductions, however those are not supported in the current implementation, and will use default settings as provided by the kernel driver.</p>
<p>Demosaicing is operating with the default parameters and could be further optimised to provide improved sharpening coefficients, checker artifact removal, and false color correction.</p>
<p>Additional image enhancements can be made by providing lens and sensor-specific tuning to adapt for Black Level compensation (BLC), Lens shading correction (SHD) and <a class="el" href="classColor.html">Color</a> correction (CCM). </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aba550913c07929582a9b6d367064ac5c" name="aba550913c07929582a9b6d367064ac5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba550913c07929582a9b6d367064ac5c">&#9670;&#160;</a></span>computeParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::IPAIPU3::computeParams </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bufferId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill and return a buffer with ISP processing parameters for a frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">frame</td><td>The frame number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferId</td><td>ID of the parameter buffer to fill</td></tr>
  </table>
  </dd>
</dl>
<p>Algorithms are expected to fill the IPU3 parameter buffer for the next frame given their most recent processing of the ImgU statistics. </p>

</div>
</div>
<a id="a9206f03f723d4eaedc61de71d44b311b" name="a9206f03f723d4eaedc61de71d44b311b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9206f03f723d4eaedc61de71d44b311b">&#9670;&#160;</a></span>configure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::ipa::ipu3::IPAIPU3::configure </td>
          <td>(</td>
          <td class="paramtype">const IPAConfigInfo &amp;&#160;</td>
          <td class="paramname"><em>configInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> *&#160;</td>
          <td class="paramname"><em>ipaControls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure the IPU3 IPA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">configInfo</td><td>The IPA configuration data, received from the pipeline handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipaControls</td><td>The IPA controls to update</td></tr>
  </table>
  </dd>
</dl>
<p>Calculate the best grid for the statistics based on the pipeline handler BDS output, and parse the minimum and maximum exposure and analogue gain control values.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Document what the BDS is, ideally in a block diagram of the ImgU.</dd></dl>
<p>All algorithm modules are called to allow them to prepare the <em><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPASessionConfiguration.html" title="Session configuration for the IPA module.">IPASessionConfiguration</a></em> structure for the <em><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html" title="Global IPA context data shared between all algorithms.">IPAContext</a></em>. </p>

</div>
</div>
<a id="ad8a1e0258a32c0c98feb4d8e6e9e9b3f" name="ad8a1e0258a32c0c98feb4d8e6e9e9b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a1e0258a32c0c98feb4d8e6e9e9b3f">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::ipa::ipu3::IPAIPU3::init </td>
          <td>(</td>
          <td class="paramtype">const IPASettings &amp;&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IPACameraSensorInfo &amp;&#160;</td>
          <td class="paramname"><em>sensorInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> &amp;&#160;</td>
          <td class="paramname"><em>sensorControls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1ControlInfoMap.html">ControlInfoMap</a> *&#160;</td>
          <td class="paramname"><em>ipaControls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the IPA module and its controls. </p>
<p>This function receives the camera sensor information from the pipeline handler, computes the limits of the controls it handles and returns them in the <em>ipaControls</em> output parameter. </p>

</div>
</div>
<a id="a7a4d547cc8ab9165e8149e62c3654f4f" name="a7a4d547cc8ab9165e8149e62c3654f4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4d547cc8ab9165e8149e62c3654f4f">&#9670;&#160;</a></span>logPrefix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string libcamera::ipa::ipu3::IPAIPU3::logPrefix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve a string to be prefixed to the log message. </p>
<p>This function allows classes inheriting from the <a class="el" href="classlibcamera_1_1Loggable.html" title="Base class to support log message extensions.">Loggable</a> class to extend the logger with an object-specific prefix output right before the log message contents.</p>
<dl class="section return"><dt>Returns</dt><dd>A string to be prefixed to the log message </dd></dl>

<p>Implements <a class="el" href="classlibcamera_1_1Loggable.html#a4cc48b0ae7215ceb4bfae6f192b2b3ee">libcamera::Loggable</a>.</p>

</div>
</div>
<a id="a3b9f197dc13f318948d281cf748516c2" name="a3b9f197dc13f318948d281cf748516c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9f197dc13f318948d281cf748516c2">&#9670;&#160;</a></span>mapBuffers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::IPAIPU3::mapBuffers </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; IPABuffer &gt; &amp;&#160;</td>
          <td class="paramname"><em>buffers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map the parameters and stats buffers allocated in the pipeline handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buffers</td><td>The buffers to map </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a501e3d74a9ddfc6fa0fb8a42dd85d5b4" name="a501e3d74a9ddfc6fa0fb8a42dd85d5b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a501e3d74a9ddfc6fa0fb8a42dd85d5b4">&#9670;&#160;</a></span>processStats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::IPAIPU3::processStats </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int64_t&#160;</td>
          <td class="paramname"><em>frameTimestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bufferId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;&#160;</td>
          <td class="paramname"><em>sensorControls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classlibcamera_1_1Process.html" title="Process object.">Process</a> the statistics generated by the ImgU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">frame</td><td>The frame number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frameTimestamp</td><td>Timestamp of the frame </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferId</td><td>ID of the statistics buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sensorControls</td><td>Sensor controls</td></tr>
  </table>
  </dd>
</dl>
<p>Parse the most recently processed image statistics from the ImgU. The statistics are passed to each algorithm module to run their calculations and update their state accordingly. </p>

</div>
</div>
<a id="a1fc0c8bfda49cc125ef94e4476bd77ba" name="a1fc0c8bfda49cc125ef94e4476bd77ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fc0c8bfda49cc125ef94e4476bd77ba">&#9670;&#160;</a></span>queueRequest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::IPAIPU3::queueRequest </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;&#160;</td>
          <td class="paramname"><em>controls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue a request and process the control list from the application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">frame</td><td>The number of the frame which will be processed next </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controls</td><td>The controls for the <em>frame</em> </td></tr>
  </table>
  </dd>
</dl>
<p>Parse the request to handle any IPA-managed controls that were set from the application such as manual sensor settings. </p>

</div>
</div>
<a id="abff233cece46b9bc1e29d43b41a95772" name="abff233cece46b9bc1e29d43b41a95772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abff233cece46b9bc1e29d43b41a95772">&#9670;&#160;</a></span>unmapBuffers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::IPAIPU3::unmapBuffers </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ids</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unmap the parameters and stats buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ids</td><td>The IDs of the buffers to unmap </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/peripherals/camera/libcamera/src/ipa/ipu3/<b>ipu3.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
