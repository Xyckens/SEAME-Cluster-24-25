<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JetPackJoyRide: libcamera::FrameBufferAllocator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">JetPackJoyRide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibcamera.html">libcamera</a></li><li class="navelem"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html">FrameBufferAllocator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classlibcamera_1_1FrameBufferAllocator-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libcamera::FrameBufferAllocator Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classlibcamera_1_1FrameBuffer.html" title="Frame buffer data and its associated dynamic metadata.">FrameBuffer</a> allocator for applications.  
 <a href="classlibcamera_1_1FrameBufferAllocator.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab66590d49bdb5dba848a74604f0b2597" id="r_ab66590d49bdb5dba848a74604f0b2597"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#ab66590d49bdb5dba848a74604f0b2597">FrameBufferAllocator</a> (std::shared_ptr&lt; <a class="el" href="classlibcamera_1_1Camera.html">Camera</a> &gt; camera)</td></tr>
<tr class="memdesc:ab66590d49bdb5dba848a74604f0b2597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> serving a camera.  <br /></td></tr>
<tr class="separator:ab66590d49bdb5dba848a74604f0b2597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d115534f49614e3466f5e86fbc43f2a" id="r_a1d115534f49614e3466f5e86fbc43f2a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a1d115534f49614e3466f5e86fbc43f2a">allocate</a> (<a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *stream)</td></tr>
<tr class="memdesc:a1d115534f49614e3466f5e86fbc43f2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate buffers for a configured stream.  <br /></td></tr>
<tr class="separator:a1d115534f49614e3466f5e86fbc43f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184749ea64aeba195bd7c8a880311cd4" id="r_a184749ea64aeba195bd7c8a880311cd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a184749ea64aeba195bd7c8a880311cd4">free</a> (<a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *stream)</td></tr>
<tr class="memdesc:a184749ea64aeba195bd7c8a880311cd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free buffers previously allocated for a <em>stream</em>.  <br /></td></tr>
<tr class="separator:a184749ea64aeba195bd7c8a880311cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9931b9d499b2d72287129aaa0d6f9fd7" id="r_a9931b9d499b2d72287129aaa0d6f9fd7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a9931b9d499b2d72287129aaa0d6f9fd7">allocated</a> () const</td></tr>
<tr class="memdesc:a9931b9d499b2d72287129aaa0d6f9fd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the allocator has allocated buffers for any stream.  <br /></td></tr>
<tr class="separator:a9931b9d499b2d72287129aaa0d6f9fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8207ce42ed29ebae26378357c2054ee7" id="r_a8207ce42ed29ebae26378357c2054ee7"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::unique_ptr&lt; <a class="el" href="classlibcamera_1_1FrameBuffer.html">FrameBuffer</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a8207ce42ed29ebae26378357c2054ee7">buffers</a> (<a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *stream) const</td></tr>
<tr class="memdesc:a8207ce42ed29ebae26378357c2054ee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the buffers allocated for a <em>stream</em>.  <br /></td></tr>
<tr class="separator:a8207ce42ed29ebae26378357c2054ee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classlibcamera_1_1FrameBuffer.html" title="Frame buffer data and its associated dynamic metadata.">FrameBuffer</a> allocator for applications. </p>
<p>The libcamera API is designed to consume buffers provided by applications as <a class="el" href="classlibcamera_1_1FrameBuffer.html" title="Frame buffer data and its associated dynamic metadata.">FrameBuffer</a> instances. This makes libcamera a user of buffers exported by other devices (such as displays or video encoders), or allocated from an external allocator (such as ION on Android platforms). In some situations, applications do not have any means to allocate or get hold of suitable buffers, for instance when no other device is involved, on Linux platforms that lack a centralized allocator. The <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> class provides a buffer allocator that can be used in these situations.</p>
<p>Applications create a framebuffer allocator for a <a class="el" href="classlibcamera_1_1Camera.html" title="Camera device.">Camera</a>, and use it to allocate buffers for streams of a <a class="el" href="classlibcamera_1_1CameraConfiguration.html" title="Hold configuration for streams of the camera.">CameraConfiguration</a> with <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a1d115534f49614e3466f5e86fbc43f2a" title="Allocate buffers for a configured stream.">allocate()</a>. They control which streams to allocate buffers for, and can thus use external buffers for a subset of the streams if desired.</p>
<p>Buffers are deleted for a stream with <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a184749ea64aeba195bd7c8a880311cd4" title="Free buffers previously allocated for a stream.">free()</a>, and destroying the allocator automatically deletes all allocated buffers. Applications own the buffers allocated by the <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> and are responsible for ensuring the buffers are not deleted while they are in use (part of a <a class="el" href="classlibcamera_1_1Request.html" title="A frame capture request.">Request</a> that has been queued and hasn't completed yet).</p>
<p>Usage of the <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> is optional, if all buffers for a camera are provided externally applications shall not use this class. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab66590d49bdb5dba848a74604f0b2597" name="ab66590d49bdb5dba848a74604f0b2597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab66590d49bdb5dba848a74604f0b2597">&#9670;&#160;</a></span>FrameBufferAllocator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libcamera::FrameBufferAllocator::FrameBufferAllocator </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classlibcamera_1_1Camera.html">Camera</a> &gt;&#160;</td>
          <td class="paramname"><em>camera</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> serving a camera. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">camera</td><td>The camera </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1d115534f49614e3466f5e86fbc43f2a" name="a1d115534f49614e3466f5e86fbc43f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d115534f49614e3466f5e86fbc43f2a">&#9670;&#160;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::FrameBufferAllocator::allocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate buffers for a configured stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stream</td><td>The stream to allocate buffers for</td></tr>
  </table>
  </dd>
</dl>
<p>Allocate buffers suitable for capturing frames from the <em>stream</em>. The <a class="el" href="classlibcamera_1_1Camera.html" title="Camera device.">Camera</a> shall have been previously configured with <a class="el" href="classlibcamera_1_1Camera.html#a4c190f4c369628e5cd96770790559a26" title="Configure the camera prior to capture.">Camera::configure()</a> and shall be stopped, and the stream shall be part of the active camera configuration.</p>
<p>Upon successful allocation, the allocated buffers can be retrieved with the <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a8207ce42ed29ebae26378357c2054ee7" title="Retrieve the buffers allocated for a stream.">buffers()</a> function.</p>
<dl class="section return"><dt>Returns</dt><dd>The number of allocated buffers on success or a negative error code otherwise </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-EACCES</td><td>The camera is not in a state where buffers can be allocated </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>The <em>stream</em> does not belong to the camera or the stream is not part of the active camera configuration </td></tr>
    <tr><td class="paramname">-EBUSY</td><td>Buffers are already allocated for the <em>stream</em> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9931b9d499b2d72287129aaa0d6f9fd7" name="a9931b9d499b2d72287129aaa0d6f9fd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9931b9d499b2d72287129aaa0d6f9fd7">&#9670;&#160;</a></span>allocated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libcamera::FrameBufferAllocator::allocated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the allocator has allocated buffers for any stream. </p>
<dl class="section return"><dt>Returns</dt><dd>True if the allocator has allocated buffers for one or more streams, false otherwise </dd></dl>

</div>
</div>
<a id="a8207ce42ed29ebae26378357c2054ee7" name="a8207ce42ed29ebae26378357c2054ee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8207ce42ed29ebae26378357c2054ee7">&#9670;&#160;</a></span>buffers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::unique_ptr&lt; <a class="el" href="classlibcamera_1_1FrameBuffer.html">FrameBuffer</a> &gt; &gt; &amp; libcamera::FrameBufferAllocator::buffers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the buffers allocated for a <em>stream</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stream</td><td>The stream to retrieve buffers for</td></tr>
  </table>
  </dd>
</dl>
<p>This function shall only be called after successfully allocating buffers for <em>stream</em> with <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a1d115534f49614e3466f5e86fbc43f2a" title="Allocate buffers for a configured stream.">allocate()</a>. The returned buffers are valid until <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a184749ea64aeba195bd7c8a880311cd4" title="Free buffers previously allocated for a stream.">free()</a> is called for the same stream or the <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html" title="FrameBuffer allocator for applications.">FrameBufferAllocator</a> instance is destroyed.</p>
<dl class="section return"><dt>Returns</dt><dd>The buffers allocated for the <em>stream</em> </dd></dl>

</div>
</div>
<a id="a184749ea64aeba195bd7c8a880311cd4" name="a184749ea64aeba195bd7c8a880311cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184749ea64aeba195bd7c8a880311cd4">&#9670;&#160;</a></span>free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::FrameBufferAllocator::free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1Stream.html">Stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free buffers previously allocated for a <em>stream</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">stream</td><td>The stream</td></tr>
  </table>
  </dd>
</dl>
<p>Free buffers allocated with <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a1d115534f49614e3466f5e86fbc43f2a" title="Allocate buffers for a configured stream.">allocate()</a>.</p>
<p>This invalidates the buffers returned by <a class="el" href="classlibcamera_1_1FrameBufferAllocator.html#a8207ce42ed29ebae26378357c2054ee7" title="Retrieve the buffers allocated for a stream.">buffers()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success or a negative error code otherwise </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-EACCES</td><td>The camera is not in a state where buffers can be freed </td></tr>
    <tr><td class="paramname">-EINVAL</td><td>The allocator do not handle the <em>stream</em> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/peripherals/camera/libcamera/include/libcamera/<a class="el" href="framebuffer__allocator_8h_source.html">framebuffer_allocator.h</a></li>
<li>src/peripherals/camera/libcamera/src/libcamera/<b>framebuffer_allocator.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
